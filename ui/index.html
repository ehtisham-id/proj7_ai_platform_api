<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Platform API Test UI</title>
    
    <!-- CDN Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.2.1/flowbite.min.css" rel="stylesheet" />
    <link href="https://unpkg.com/filepond@4.30.4/dist/filepond.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet"/>
    <script src="https://cdn.jsdelivr.net/npm/axios@1.6.5/dist/axios.min.js"></script>
    <script src="https://unpkg.com/filepond@4.30.4/dist/filepond.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    
    <style>
        .section-content { display: none; }
        .section-content.active { display: block; }
        .toast { position: fixed; top: 20px; right: 20px; z-index: 1000; }
        #debug-console { max-height: 300px; overflow-y: auto; }
    </style>
</head>
<body class="bg-gray-100">

<script>
// ============================================
// CONFIGURATION - Edit these values
// ============================================
const API_BASE = "http://localhost:8000/api/v1";
const WS_BASE = "ws://localhost:8000/ws/notifications";
const USE_WS_AUTH_QUERY = true; // Set to false to use Authorization header for WebSocket

// ============================================
// HELPER FUNCTIONS
// ============================================
let accessToken = localStorage.getItem('access_token') || '';
let refreshToken = localStorage.getItem('refresh_token') || '';

function authHeaders() {
    return accessToken ? { 'Authorization': `Bearer ${accessToken}` } : {};
}

function saveTokens(access, refresh) {
    accessToken = access;
    refreshToken = refresh;
    localStorage.setItem('access_token', access);
    if (refresh) localStorage.setItem('refresh_token', refresh);
    updateTokenDisplay();
}

function clearTokens() {
    accessToken = '';
    refreshToken = '';
    localStorage.removeItem('access_token');
    localStorage.removeItem('refresh_token');
    updateTokenDisplay();
}

function updateTokenDisplay() {
    document.getElementById('token-display').textContent = 
        accessToken ? `Token: ${accessToken.substring(0, 20)}...` : 'No token set';
}

function showToast(message, type = 'success') {
    const toast = document.createElement('div');
    toast.className = `toast animate__animated animate__fadeInDown px-6 py-4 rounded-lg shadow-lg ${
        type === 'success' ? 'bg-green-500' : 'bg-red-500'
    } text-white`;
    toast.textContent = message;
    document.body.appendChild(toast);
    setTimeout(() => {
        toast.classList.replace('animate__fadeInDown', 'animate__fadeOutUp');
        setTimeout(() => toast.remove(), 500);
    }, 3000);
}

function logDebug(title, data) {
    const console = document.getElementById('debug-console');
    const entry = document.createElement('div');
    entry.className = 'mb-2 p-2 bg-gray-700 rounded text-xs';
    entry.innerHTML = `<strong class="text-yellow-300">${title}</strong><pre class="text-green-300 mt-1">${JSON.stringify(data, null, 2)}</pre>`;
    console.insertBefore(entry, console.firstChild);
}

async function handleResponse(promise, successMsg) {
    try {
        const response = await promise;
        logDebug('Response', response.data);
        showToast(successMsg);
        return response.data;
    } catch (error) {
        handleError(error);
        throw error;
    }
}

function handleError(error) {
    const msg = error.response?.data?.detail || error.message || 'Request failed';
    logDebug('Error', { message: msg, status: error.response?.status });
    showToast(msg, 'error');
}

function multipartJSONField(formData, name, obj) {
    formData.append(name, JSON.stringify(obj));
}

function copyToClipboard(text) {
    navigator.clipboard.writeText(text);
    showToast('Copied to clipboard');
}

function switchSection(sectionId) {
    document.querySelectorAll('.section-content').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('.menu-item').forEach(m => m.classList.remove('bg-blue-600'));
    document.getElementById(sectionId).classList.add('active');
    document.querySelector(`[data-section="${sectionId}"]`).classList.add('bg-blue-600');
}

// ============================================
// API FUNCTIONS
// ============================================

// Auth
async function register() {
    const email = document.getElementById('reg-email').value;
    const password = document.getElementById('reg-password').value;
    const data = await handleResponse(
        axios.post(`${API_BASE}/auth/register`, { email, password, role: 'user' }),
        'Registration successful'
    );
    document.getElementById('auth-result').textContent = JSON.stringify(data, null, 2);
}

async function login() {
    const username = document.getElementById('login-email').value;
    const password = document.getElementById('login-password').value;
    const formData = new URLSearchParams();
    formData.append('username', username);
    formData.append('password', password);
    
    const data = await handleResponse(
        axios.post(`${API_BASE}/auth/login`, formData, {
            headers: { 'Content-Type': 'application/x-www-form-urlencoded' }
        }),
        'Login successful'
    );
    saveTokens(data.access_token, data.refresh_token);
    document.getElementById('auth-result').textContent = JSON.stringify(data, null, 2);
}

async function refresh() {
    const data = await handleResponse(
        axios.post(`${API_BASE}/auth/refresh`, { refresh_token: refreshToken }),
        'Token refreshed'
    );
    saveTokens(data.access_token, data.refresh_token);
    document.getElementById('auth-result').textContent = JSON.stringify(data, null, 2);
}

// Files
async function uploadFile() {
    const fileInput = document.getElementById('file-upload');
    const formData = new FormData();
    formData.append('file', fileInput.files[0]);
    
    const data = await handleResponse(
        axios.post(`${API_BASE}/files/`, formData, { headers: authHeaders() }),
        'File uploaded'
    );
    displayFileResult(data);
}

async function getFile() {
    const fileId = document.getElementById('file-id-get').value;
    const response = await axios.get(`${API_BASE}/files/${fileId}`, {
        headers: authHeaders(),
        responseType: 'blob'
    });
    
    const url = window.URL.createObjectURL(new Blob([response.data]));
    const link = document.createElement('a');
    link.href = url;
    link.setAttribute('download', `file_${fileId}`);
    document.body.appendChild(link);
    link.click();
    link.remove();
    showToast('File downloaded');
}

async function deleteFile() {
    const fileId = document.getElementById('file-id-delete').value;
    await handleResponse(
        axios.delete(`${API_BASE}/files/${fileId}`, { headers: authHeaders() }),
        'File deleted'
    );
}

async function renameFile() {
    const fileId = document.getElementById('file-id-rename').value;
    const newName = document.getElementById('file-new-name').value;
    const data = await handleResponse(
        axios.put(`${API_BASE}/files/${fileId}/rename`, { new_name: newName }, { headers: authHeaders() }),
        'File renamed'
    );
    displayFileResult(data);
}

async function getVersions() {
    const fileId = document.getElementById('file-id-versions').value;
    const data = await handleResponse(
        axios.get(`${API_BASE}/files/${fileId}/versions`, { headers: authHeaders() }),
        'Versions retrieved'
    );
    document.getElementById('files-result').textContent = JSON.stringify(data, null, 2);
}

function displayFileResult(data) {
    const result = document.getElementById('files-result');
    result.innerHTML = `
        <div class="bg-white p-4 rounded">
            <p><strong>File ID:</strong> ${data.id}</p>
            <p><strong>Filename:</strong> ${data.filename}</p>
            <p><strong>Size:</strong> ${data.size_bytes} bytes</p>
            <p><strong>MIME:</strong> ${data.mime_type || 'N/A'}</p>
            ${data.url ? `<a href="${data.url}" class="text-blue-500 underline" target="_blank">Download</a>` : ''}
        </div>
    `;
}

// Convert
async function convertFile() {
    const fileInput = document.getElementById('convert-file');
    const targetFormat = document.getElementById('convert-format').value;
    const formData = new FormData();
    formData.append('file', fileInput.files[0]);
    multipartJSONField(formData, 'conversion', { target_format: targetFormat });
    
    const data = await handleResponse(
        axios.post(`${API_BASE}/convert/`, formData, { headers: authHeaders() }),
        'File converted'
    );
    displayConvertResult(data);
}

function displayConvertResult(data) {
    document.getElementById('convert-result').innerHTML = `
        <div class="bg-white p-4 rounded">
            <p><strong>Converted File ID:</strong> ${data.converted_file_id}</p>
            <p><strong>Filename:</strong> ${data.filename}</p>
            <p><strong>Format:</strong> ${data.source_format} ‚Üí ${data.target_format}</p>
            <p><strong>Size:</strong> ${data.size_bytes} bytes</p>
            <a href="${data.url}" class="text-blue-500 underline" target="_blank">Download</a>
        </div>
    `;
}

// Photo Edit
async function editPhoto() {
    const fileInput = document.getElementById('photo-file');
    const filter = document.getElementById('photo-filter').value;
    const rotate = parseInt(document.getElementById('photo-rotate').value);
    const formData = new FormData();
    formData.append('file', fileInput.files[0]);
    
    const operations = { filter, rotate };
    const cropX = document.getElementById('crop-x').value;
    if (cropX) {
        operations.crop = {
            x: parseInt(cropX),
            y: parseInt(document.getElementById('crop-y').value),
            w: parseInt(document.getElementById('crop-w').value),
            h: parseInt(document.getElementById('crop-h').value)
        };
    }
    
    multipartJSONField(formData, 'operations', operations);
    
    const data = await handleResponse(
        axios.post(`${API_BASE}/photo/edit`, formData, { headers: authHeaders() }),
        'Photo edited'
    );
    displayPhotoResult(data);
}

function displayPhotoResult(data) {
    document.getElementById('photo-result').innerHTML = `
        <div class="bg-white p-4 rounded">
            <p><strong>Edited File ID:</strong> ${data.edited_file_id}</p>
            <p><strong>Filename:</strong> ${data.filename}</p>
            <p><strong>Size:</strong> ${data.size_bytes} bytes</p>
            <p><strong>Operations:</strong> ${JSON.stringify(data.operations)}</p>
            <a href="${data.url}" class="text-blue-500 underline" target="_blank">Download</a>
            <br><img src="${data.url}" class="mt-2 max-w-md" alt="Edited photo">
        </div>
    `;
}

// PDF
async function mergePDF() {
    const fileInput = document.getElementById('pdf-merge-files');
    const formData = new FormData();
    Array.from(fileInput.files).forEach(file => {
        formData.append('files', file);
    });
    
    const data = await handleResponse(
        axios.post(`${API_BASE}/pdf/merge`, formData, { headers: authHeaders() }),
        'PDFs merged'
    );
    document.getElementById('pdf-result').textContent = JSON.stringify(data, null, 2);
}

async function convertToPDF() {
    const fileInput = document.getElementById('pdf-convert-file');
    const formData = new FormData();
    formData.append('file', fileInput.files[0]);
    
    const data = await handleResponse(
        axios.post(`${API_BASE}/pdf/convert`, formData, { headers: authHeaders() }),
        'Converted to PDF'
    );
    document.getElementById('pdf-result').textContent = JSON.stringify(data, null, 2);
}

// QR Code
async function generateQR() {
    const text = document.getElementById('qr-text').value;
    const size = parseInt(document.getElementById('qr-size').value);
    
    const data = await handleResponse(
        axios.post(`${API_BASE}/qrcode/generate`, { text, size }, { headers: authHeaders() }),
        'QR code generated'
    );
    
    document.getElementById('qr-result').innerHTML = `
        <div class="bg-white p-4 rounded">
            <p><strong>QR Code File ID:</strong> ${data.qrcode_file_id}</p>
            <p><strong>Size:</strong> ${data.size}px</p>
            <a href="${data.url}" class="text-blue-500 underline" target="_blank">Download</a>
            <br><img src="${data.url}" class="mt-2" alt="QR Code">
        </div>
    `;
}

// Summarize
let pollInterval;
async function summarizeFile() {
    const fileInput = document.getElementById('summarize-file');
    const formData = new FormData();
    formData.append('file', fileInput.files[0]);
    
    const data = await handleResponse(
        axios.post(`${API_BASE}/summarize/`, formData, { headers: authHeaders() }),
        'Summarization job queued'
    );
    
    document.getElementById('summarize-result').textContent = `Job ID: ${data.job_id}\nStatus: ${data.status}\n\nPolling for results...`;
    
    // Poll for completion
    pollInterval = setInterval(async () => {
        try {
            const jobData = await axios.get(`${API_BASE}/summarize/jobs/${data.job_id}`, { headers: authHeaders() });
            logDebug('Job Status', jobData.data);
            
            if (jobData.data.status === 'completed') {
                clearInterval(pollInterval);
                document.getElementById('summarize-result').innerHTML = `
                    <div class="bg-white p-4 rounded">
                        <p><strong>Status:</strong> ${jobData.data.status}</p>
                        <a href="${jobData.data.result_url}" class="text-blue-500 underline" target="_blank">Download Summary</a>
                    </div>
                `;
                showToast('Summarization completed');
            }
        } catch (err) {
            clearInterval(pollInterval);
            handleError(err);
        }
    }, 2000);
}

// AR Menu
async function createARMenu() {
    const fileInput = document.getElementById('ar-menu-file');
    const formData = new FormData();
    formData.append('file', fileInput.files[0]);
    
    const data = await handleResponse(
        axios.post(`${API_BASE}/ar/menu/create`, formData, { headers: authHeaders() }),
        'AR Menu created'
    );
    
    document.getElementById('ar-result').innerHTML = `
        <div class="bg-white p-4 rounded">
            <p><strong>AR Menu ID:</strong> ${data.ar_menu_id}</p>
            <p><strong>Item Count:</strong> ${data.item_count}</p>
            <p><strong>QR Count:</strong> ${data.qr_count}</p>
            <a href="${data.preview_url}" class="text-blue-500 underline" target="_blank">Preview</a>
            <br><a href="${data.menu_url}" class="text-blue-500 underline" target="_blank">Menu URL</a>
        </div>
    `;
}

// Analysis
let analysisChart;
async function uploadAnalysis() {
    const fileInput = document.getElementById('analysis-file');
    const formData = new FormData();
    formData.append('file', fileInput.files[0]);
    
    const data = await handleResponse(
        axios.post(`${API_BASE}/analysis/upload`, formData, { headers: authHeaders() }),
        'Analysis completed'
    );
    
    document.getElementById('analysis-result').innerHTML = `
        <div class="bg-white p-4 rounded">
            <p><strong>Analysis ID:</strong> ${data.analysis_id}</p>
            <p><strong>Summary:</strong></p>
            <pre>${JSON.stringify(data.summary, null, 2)}</pre>
            <canvas id="analysis-chart" class="mt-4"></canvas>
        </div>
    `;
    
    // Render chart if data available
    if (data.summary && data.summary.rows) {
        const ctx = document.getElementById('analysis-chart').getContext('2d');
        if (analysisChart) analysisChart.destroy();
        analysisChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Rows', 'Columns'],
                datasets: [{
                    label: 'Data Metrics',
                    data: [data.summary.rows, data.columns?.length || 0],
                    backgroundColor: ['rgba(54, 162, 235, 0.5)', 'rgba(255, 99, 132, 0.5)']
                }]
            },
            options: {
                responsive: true,
                animation: { duration: 1000 }
            }
        });
    }
}

// WebSocket
let ws;
function connectWebSocket() {
    const url = USE_WS_AUTH_QUERY 
        ? `${WS_BASE}?token=${accessToken}`
        : WS_BASE;
    
    ws = new WebSocket(url);
    
    ws.onopen = () => {
        showToast('WebSocket connected');
        document.getElementById('ws-status').textContent = 'Connected';
        document.getElementById('ws-status').className = 'text-green-500 font-bold';
    };
    
    ws.onmessage = (event) => {
        const data = JSON.parse(event.data);
        logDebug('WebSocket Message', data);
        
        const notif = document.createElement('div');
        notif.className = 'animate__animated animate__fadeInRight bg-blue-100 p-3 rounded mb-2';
        notif.innerHTML = `<strong>${data.message}</strong><pre class="text-xs">${JSON.stringify(data.data, null, 2)}</pre>`;
        document.getElementById('ws-notifications').insertBefore(notif, document.getElementById('ws-notifications').firstChild);
    };
    
    ws.onerror = (error) => {
        showToast('WebSocket error', 'error');
        logDebug('WebSocket Error', error);
    };
    
    ws.onclose = () => {
        showToast('WebSocket disconnected', 'error');
        document.getElementById('ws-status').textContent = 'Disconnected';
        document.getElementById('ws-status').className = 'text-red-500 font-bold';
    };
}

function disconnectWebSocket() {
    if (ws) {
        ws.close();
        ws = null;
    }
}

// ============================================
// INITIALIZATION
// ============================================
window.onload = () => {
    updateTokenDisplay();
    switchSection('auth-section');
    
    // Example data buttons
    document.getElementById('fill-register').onclick = () => {
        document.getElementById('reg-email').value = 'test@example.com';
        document.getElementById('reg-password').value = 'password123';
    };
    
    document.getElementById('fill-login').onclick = () => {
        document.getElementById('login-email').value = 'test@example.com';
        document.getElementById('login-password').value = 'password123';
    };
    
    document.getElementById('fill-qr').onclick = () => {
        document.getElementById('qr-text').value = 'https://example.com';
        document.getElementById('qr-size').value = '256';
    };
};
</script>

<div class="flex h-screen">
    <!-- Left Sidebar -->
    <div class="w-64 bg-gray-800 text-white p-4 overflow-y-auto">
        <h1 class="text-2xl font-bold mb-6">AI Platform API</h1>
        
        <div id="token-display" class="text-xs bg-gray-700 p-2 rounded mb-4 break-all"></div>
        <button onclick="clearTokens()" class="w-full bg-red-500 hover:bg-red-600 px-4 py-2 rounded mb-6 text-sm">Reset Tokens</button>
        
        <nav>
            <button onclick="switchSection('auth-section')" data-section="auth-section" class="menu-item w-full text-left px-4 py-3 rounded mb-2 hover:bg-blue-500 bg-blue-600">üîê Auth</button>
            <button onclick="switchSection('files-section')" data-section="files-section" class="menu-item w-full text-left px-4 py-3 rounded mb-2 hover:bg-blue-500">üìÅ Files</button>
            <button onclick="switchSection('convert-section')" data-section="convert-section" class="menu-item w-full text-left px-4 py-3 rounded mb-2 hover:bg-blue-500">üîÑ Convert</button>
            <button onclick="switchSection('photo-section')" data-section="photo-section" class="menu-item w-full text-left px-4 py-3 rounded mb-2 hover:bg-blue-500">üñºÔ∏è Photo</button>
            <button onclick="switchSection('pdf-section')" data-section="pdf-section" class="menu-item w-full text-left px-4 py-3 rounded mb-2 hover:bg-blue-500">üìÑ PDF</button>
            <button onclick="switchSection('qr-section')" data-section="qr-section" class="menu-item w-full text-left px-4 py-3 rounded mb-2 hover:bg-blue-500">üì± QR Code</button>
            <button onclick="switchSection('summarize-section')" data-section="summarize-section" class="menu-item w-full text-left px-4 py-3 rounded mb-2 hover:bg-blue-500">üìù Summarize</button>
            <button onclick="switchSection('ar-section')" data-section="ar-section" class="menu-item w-full text-left px-4 py-3 rounded mb-2 hover:bg-blue-500">ü•Ω AR Menu</button>
            <button onclick="switchSection('analysis-section')" data-section="analysis-section" class="menu-item w-full text-left px-4 py-3 rounded mb-2 hover:bg-blue-500">üìä Analysis</button>
            <button onclick="switchSection('ws-section')" data-section="ws-section" class="menu-item w-full text-left px-4 py-3 rounded mb-2 hover:bg-blue-500">üîî WebSocket</button>
        </nav>
    </div>
    
    <!-- Main Content -->
    <div class="flex-1 overflow-y-auto p-8">
        <!-- Auth Section -->
        <div id="auth-section" class="section-content animate__animated animate__fadeIn">
            <h2 class="text-3xl font-bold mb-6">Authentication</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-xl font-bold mb-4">Register</h3>
                    <input id="reg-email" type="email" placeholder="Email" class="w-full p-2 border rounded mb-2">
                    <input id="reg-password" type="password" placeholder="Password" class="w-full p-2 border rounded mb-4">
                    <button onclick="register()" class="w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded">Register</button>
                    <button id="fill-register" class="w-full mt-2 bg-gray-300 hover:bg-gray-400 px-4 py-2 rounded text-sm">Fill Example</button>
                </div>
                
                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-xl font-bold mb-4">Login</h3>
                    <input id="login-email" type="email" placeholder="Email" class="w-full p-2 border rounded mb-2">
                    <input id="login-password" type="password" placeholder="Password" class="w-full p-2 border rounded mb-4">
                    <button onclick="login()" class="w-full bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded">Login</button>
                    <button id="fill-login" class="w-full mt-2 bg-gray-300 hover:bg-gray-400 px-4 py-2 rounded text-sm">Fill Example</button>
                </div>
                
                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-xl font-bold mb-4">Refresh Token</h3>
                    <button onclick="refresh()" class="w-full bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded">Refresh</button>
                </div>
            </div>
            
            <div class="mt-6 bg-white p-6 rounded-lg shadow">
                <h3 class="text-xl font-bold mb-4">Result</h3>
                <pre id="auth-result" class="bg-gray-100 p-4 rounded text-sm overflow-x-auto"></pre>
            </div>
        </div>
        
        <!-- Files Section -->
        <div id="files-section" class="section-content">
            <h2 class="text-3xl font-bold mb-6">File Management</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-xl font-bold mb-4">Upload File</h3>
                    <input id="file-upload" type="file" class="w-full mb-4">
                    <button onclick="uploadFile()" class="w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded">Upload</button>
                </div>
                
                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-xl font-bold mb-4">Get File</h3>
                    <input id="file-id-get" type="number" placeholder="File ID" class="w-full p-2 border rounded mb-4">
                    <button onclick="getFile()" class="w-full bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded">Download</button>
                </div>
                
                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-xl font-bold mb-4">Delete File</h3>
                    <input id="file-id-delete" type="number" placeholder="File ID" class="w-full p-2 border rounded mb-4">
                    <button onclick="deleteFile()" class="w-full bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded">Delete</button>
                </div>
                
                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-xl font-bold mb-4">Rename File</h3>
                    <input id="file-id-rename" type="number" placeholder="File ID" class="w-full p-2 border rounded mb-2">
                    <input id="file-new-name" type="text" placeholder="New filename" class="w-full p-2 border rounded mb-4">
                    <button onclick="renameFile()" class="w-full bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded">Rename</button>
                </div>
                
                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-xl font-bold mb-4">Get Versions</h3>
                    <input id="file-id-versions" type="number" placeholder="File ID" class="w-full p-2 border rounded mb-4">
                    <button onclick="getVersions()" class="w-full bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded">Get Versions</button>
                </div>
            </div>
            
            <div class="mt-6 bg-white p-6 rounded-lg shadow">
                <h3 class="text-xl font-bold mb-4">Result</h3>
                <pre id="files-result" class="bg-gray-100 p-4 rounded text-sm overflow-x-auto"></pre>
            </div>
        </div>
        
        <!-- Convert Section -->
        <div id="convert-section" class="section-content">
            <h2 class="text-3xl font-bold mb-6">File Conversion</h2>
            
            <div class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-xl font-bold mb-4">Convert File</h3>
                <input id="convert-file" type="file" class="w-full mb-4">
                <select id="convert-format" class="w-full p-2 border rounded mb-4">
                    <option value="pdf">PDF</option>
                    <option value="docx">DOCX</option>
                    <option value="txt">TXT</option>
                    <option value="jpg">JPG</option>
                    <option value="png">PNG</option>
                </select>
                <button onclick="convertFile()" class="w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded">Convert</button>
            </div>
            
            <div class="mt-6 bg-white p-6 rounded-lg shadow">
                <h3 class="text-xl font-bold mb-4">Result</h3>
                <div id="convert-result" class="bg-gray-100 p-4 rounded"></div>
            </div>
        </div>
        
        <!-- Photo Section -->
        <div id="photo-section" class="section-content">
            <h2 class="text-3xl font-bold mb-6">Photo Editing</h2>
            
            <div class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-xl font-bold mb-4">Edit Photo</h3>
                <input id="photo-file" type="file" accept="image/*" class="w-full mb-4">
                
                <label class="block mb-2">Filter:</label>
                <select id="photo-filter" class="w-full p-2 border rounded mb-4">
                    <option value="">None</option>
                    <option value="grayscale">Grayscale</option>
                    <option value="sepia">Sepia</option>
                    <option value="blur">Blur</option>
                </select>
                
                <label class="block mb-2">Rotate (degrees):</label>
                <input id="photo-rotate" type="number" value="0" class="w-full p-2 border rounded mb-4">
                
                <label class="block mb-2">Crop (optional):</label>
                <div class="grid grid-cols-4 gap-2 mb-4">
                    <input id="crop-x" type="number" placeholder="X" class="p-2 border rounded">
                    <input id="crop-y" type="number" placeholder="Y" class="p-2 border rounded">
                    <input id="crop-w" type="number" placeholder="Width" class="p-2 border rounded">
                    <input id="crop-h" type="number" placeholder="Height" class="p-2 border rounded">
                </div>
                
                <button onclick="editPhoto()" class="w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded">Edit Photo</button>
            </div>
            
            <div class="mt-6 bg-white p-6 rounded-lg shadow">
                <h3 class="text-xl font-bold mb-4">Result</h3>
                <div id="photo-result"></div>
            </div>
        </div>
        
        <!-- PDF Section -->
        <div id="pdf-section" class="section-content">
            <h2 class="text-3xl font-bold mb-6">PDF Operations</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-xl font-bold mb-4">Merge PDFs</h3>
                    <input id="pdf-merge-files" type="file" accept=".pdf" multiple class="w-full mb-4">
                    <button onclick="mergePDF()" class="w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded">Merge</button>
                </div>
                
                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-xl font-bold mb-4">Convert to PDF</h3>
                    <input id="pdf-convert-file" type="file" class="w-full mb-4">
                    <button onclick="convertToPDF()" class="w-full bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded">Convert</button>
                </div>
            </div>
            
            <div class="mt-6 bg-white p-6 rounded-lg shadow">
                <h3 class="text-xl font-bold mb-4">Result</h3>
                <pre id="pdf-result" class="bg-gray-100 p-4 rounded text-sm overflow-x-auto"></pre>
            </div>
        </div>
        
        <!-- QR Section -->
        <div id="qr-section" class="section-content">
            <h2 class="text-3xl font-bold mb-6">QR Code Generator</h2>
            
            <div class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-xl font-bold mb-4">Generate QR Code</h3>
                <input id="qr-text" type="text" placeholder="Text or URL" class="w-full p-2 border rounded mb-4">
                <input id="qr-size" type="number" placeholder="Size (px)" value="256" class="w-full p-2 border rounded mb-4">
                <button onclick="generateQR()" class="w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded mb-2">Generate</button>
                <button id="fill-qr" class="w-full bg-gray-300 hover:bg-gray-400 px-4 py-2 rounded text-sm">Fill Example</button>
            </div>
            
            <div class="mt-6 bg-white p-6 rounded-lg shadow">
                <h3 class="text-xl font-bold mb-4">Result</h3>
                <div id="qr-result"></div>
            </div>
        </div>
        
        <!-- Summarize Section -->
        <div id="summarize-section" class="section-content">
            <h2 class="text-3xl font-bold mb-6">Text Summarization</h2>
            
            <div class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-xl font-bold mb-4">Upload Text File</h3>
                <input id="summarize-file" type="file" accept=".txt,.md" class="w-full mb-4">
                <button onclick="summarizeFile()" class="w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded">Summarize</button>
            </div>
            
            <div class="mt-6 bg-white p-6 rounded-lg shadow">
                <h3 class="text-xl font-bold mb-4">Result</h3>
                <pre id="summarize-result" class="bg-gray-100 p-4 rounded text-sm overflow-x-auto"></pre>
            </div>
        </div>
        
        <!-- AR Section -->
        <div id="ar-section" class="section-content">
            <h2 class="text-3xl font-bold mb-6">AR Menu Creator</h2>
            
            <div class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-xl font-bold mb-4">Upload Menu Data (CSV/JSON)</h3>
                <input id="ar-menu-file" type="file" accept=".csv,.json" class="w-full mb-4">
                <button onclick="createARMenu()" class="w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded">Create AR Menu</button>
            </div>
            
            <div class="mt-6 bg-white p-6 rounded-lg shadow">
                <h3 class="text-xl font-bold mb-4">Result</h3>
                <div id="ar-result"></div>
            </div>
        </div>
        
        <!-- Analysis Section -->
        <div id="analysis-section" class="section-content">
            <h2 class="text-3xl font-bold mb-6">Data Analysis</h2>
            
            <div class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-xl font-bold mb-4">Upload Data File (CSV/XLSX)</h3>
                <input id="analysis-file" type="file" accept=".csv,.xlsx" class="w-full mb-4">
                <button onclick="uploadAnalysis()" class="w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded">Analyze</button>
            </div>
            
            <div class="mt-6 bg-white p-6 rounded-lg shadow">
                <h3 class="text-xl font-bold mb-4">Result</h3>
                <div id="analysis-result"></div>
            </div>
        </div>
        
        <!-- WebSocket Section -->
        <div id="ws-section" class="section-content">
            <h2 class="text-3xl font-bold mb-6">WebSocket Notifications</h2>
            
            <div class="bg-white p-6 rounded-lg shadow mb-6">
                <h3 class="text-xl font-bold mb-4">Connection</h3>
                <p class="mb-4">Status: <span id="ws-status" class="text-red-500 font-bold">Disconnected</span></p>
                <div class="grid grid-cols-2 gap-4">
                    <button onclick="connectWebSocket()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded">Connect</button>
                    <button onclick="disconnectWebSocket()" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded">Disconnect</button>
                </div>
            </div>
            
            <div class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-xl font-bold mb-4">Notifications</h3>
                <div id="ws-notifications" class="space-y-2 max-h-96 overflow-y-auto"></div>
            </div>
        </div>
        
        <!-- Debug Console -->
        <div class="mt-8 bg-gray-800 p-6 rounded-lg shadow">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-white">Debug Console</h3>
                <button onclick="document.getElementById('debug-console').innerHTML=''" class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm">Clear</button>
            </div>
            <div id="debug-console" class="text-white text-xs"></div>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.2.1/flowbite.min.js"></script>
</body>
</html>